<!DOCTYPE html>
<html lang="my">
<head>
    <title>ရှေ့ဆက်ရမယ့်လမ်း- စိတ်ဝင်စားဖွယ်ရာ လမ်းညွှန်</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
        /* Import Myanmar Font */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Myanmar:wght@300;400;700&display=swap');

        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            /* Use the Myanmar font */
            font-family: 'Noto Sans Myanmar', sans-serif;
            color: white;
        }
        #story-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 600px;
            text-align: center;
            z-index: 1;
            padding: 20px;
            cursor: pointer;
            transition: opacity 1.5s ease;
        }
        #story-overlay h1 {
            font-size: 2.5em;
            line-height: 1.4;
            margin: 0;
            text-shadow: 0 0 10px rgba(0,0,0,0.7);
        }
        #story-overlay p {
            font-size: 1.2em;
            line-height: 1.8;
            margin-top: 15px;
            text-shadow: 0 0 8px rgba(0,0,0,0.7);
        }
        #prompt {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.7);
            font-weight: bold;
            font-size: 1.1em;
            animation: pulse 2s infinite;
            z-index: 2;
        }
        #breathing-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3;
            font-size: 3em;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(0,0,0,0.8);
            opacity: 0;
            transition: opacity 1s ease-in-out;
            pointer-events: none; /* Allows clicks to go through it */
        }
        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <div id="story-overlay">
        <h1 id="story-title"></h1>
        <p id="story-text"></p>
    </div>
    <div id="prompt">စတင်ရန် နှိပ်ပါ</div>
    <div id="breathing-indicator"></div>

    <audio id="background-music" loop src="./please-calm-my-mind-125566.mp3"></audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        // --- MYANMAR NARRATIVE CONTENT ---
        const story = [
            {
                title: "လမ်းပျောက်နေသလို ခံစားနေရလား။",
                text: "ဘဝဟာ ဖိအားတွေများတဲ့ မုန်တိုင်းတစ်ခုလို ရှုပ်ထွေးနေနိုင်ပါတယ်။ ပိုက်ဆံရှာရမယ့်လိုအပ်ချက်နဲ့ ငြိမ်းချမ်းလိုတဲ့ဆန္ဒကြားမှာ လမ်းပျောက်နေတယ်လို့ ခံစားရလွယ်ပါတယ်။"
            },
            {
                title: "သင်၏ကျောက်ဆူးကို ရှာဖွေပါ",
                text: "ပထမဆုံးအဆင့်က မုန်တိုင်းကို ငြိမ်အောင်လုပ်ဖို့မဟုတ်ဘဲ သင့်ကိုယ်သင် တည်ငြိမ်အောင်လုပ်ဖို့ပါပဲ။ ငြိမ်းချမ်းမှုဟာ အတွင်းစိတ်ထဲမှာ ရှိပါတယ်။ ဒီကနေ စလိုက်ကြရအောင်။ ဒါကတော့ စိတ်တည်ငြိမ်ရာ လမ်း ဖြစ်ပါတယ်။"
            },
            {
                title: "သင့်အသက်ရှုမှုကို ထိန်းချုပ်ပါ",
                text: "သင့်ရဲ့အသက်ရှုမှုဟာ ပစ္စုပ္ပန်ကိုဆွဲထားတဲ့ ကျောက်ဆူးတစ်ခုပါပဲ။ ဘယ်အချိန်၊ ဘယ်နေရာမှာမဆို တည်ငြိမ်မှုကိုရှာဖွေဖို့ အသုံးပြုနိုင်တဲ့ ကိရိယာတစ်ခုပါ။ လမ်းညွှန်အတိုင်း လိုက်လုပ်ပါ။"
            },
            {
                title: "သင်၏တန်ဖိုးသည် သင်၏ပိုက်ဆံအိတ် မဟုတ်ပါ",
                text: "အရာအားလုံးထက် ဒါကို သတိရပါ။ လူတစ်ယောက်အနေနဲ့ သင့်ရဲ့တန်ဖိုးဟာ သင့်ဘဏ်အကောင့်နဲ့ ဘာမှမဆိုင်ပါဘူး။ သင်ဟာ သင့်ရဲ့ရုန်းကန်မှုတွေထက် ပိုတန်ဖိုးရှိပါတယ်။ ကိုယ့်ကိုယ်ကိုယ် ကြင်နာပါ။"
            },
            {
                title: "သင်၏အုတ်မြစ်ကို တည်ဆောက်ပါ",
                text: "ပိုတည်ငြိမ်တဲ့စိတ်နဲ့အတူ ပိုလုံခြုံတဲ့အနာဂတ်အတွက် အုတ်မြစ်တွေကို စတင်ချမှတ်နိုင်ပါပြီ။ ဒါကတော့ လုံခြုံမှုဆီသို့ လမ်း ဖြစ်ပါတယ်။ သေးငယ်တဲ့အရာကနေ စတင်ရပါတယ်။"
            },
            {
                title: "အသိပညာသည် စွမ်းအားဖြစ်သည်",
                text: "ပထမဆုံး သင်ဘယ်နေရာမှာ ရှိနေလဲဆိုတာ နားလည်ပါ။ သင့်ရဲ့ဘဏ္ဍာရေးကို အပြစ်မတင်ဘဲ ကြည့်ပါ။ သင့်ရဲ့စမှတ်ကို မသိဘဲ ခရီးတစ်ခုကို စီစဉ်လို့မရပါဘူး။"
            },
            {
                title: "သင်ကိုယ်တိုင်အတွက် ရင်းနှီးမြှုပ်နှံပါ",
                text: "သင့်ရဲ့အကြီးမားဆုံးသော အရာကတော့ သင်ယူနိုင်စွမ်းပါပဲ။ သင်ရရှိလိုက်တဲ့ ကျွမ်းကျင်မှုအသစ်တိုင်းက သင့်တန်ဖိုးကို တိုးစေပြီး တံခါးအသစ်တွေကို ဖွင့်ပေးပါတယ်။ ဒါဟာ ကြီးပွားတိုးတက်မှုအတွက် အသေချာဆုံးလမ်းပါပဲ။"
            },
            {
                title: "อรุณรุ่งใหม่",
                text: "သင့်စိတ်ကို တည်ငြိမ်အောင်ထားပြီး သေးငယ်ပေမယ့် တစိုက်မတ်မတ်လုပ်ဆောင်ခြင်းဖြင့် သင်ဟာ လက်တွေ့ဘဝအသစ်တစ်ခုကို ဖန်တီးနိုင်ပါတယ်။ လမ်းကရှည်လျားပေမယ့် သင်ကိုယ်တိုင် လျှောက်လှမ်းနေတာပါ။ သင့်မှာ ရှေ့ဆက်ဖို့ စွမ်းအားရှိပါတယ်။"
            },
        ];

        // --- THREE.JS SETUP ---
        let scene, camera, renderer, particles, material;
        let currentStep = -1;
        const storyOverlay = document.getElementById('story-overlay');
        const storyTitle = document.getElementById('story-title');
        const storyText = document.getElementById('story-text');
        const prompt = document.getElementById('prompt');
        const breathingIndicator = document.getElementById('breathing-indicator');
        const music = document.getElementById('background-music');
        let breathingTimeouts = [];
        let musicStarted = false;

        const sceneState = {
            particleSpeed: 0.005,
            targetColor: new THREE.Color(0x555555),
            cameraZ: 5
        };

        function init() {
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x000000, 0.001);
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1000);
            camera.position.z = sceneState.cameraZ;
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);
            const geometry = new THREE.BufferGeometry();
            const vertices = [];
            const particleCount = 5000;
            for (let i = 0; i < particleCount; i++) {
                vertices.push((Math.random() - 0.5) * 20, (Math.random() - 0.5) * 20, (Math.random() - 0.5) * 20);
            }
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
            material = new THREE.PointsMaterial({
                color: sceneState.targetColor,
                size: 0.05,
                transparent: true,
                blending: THREE.AdditiveBlending
            });
            particles = new THREE.Points(geometry, material);
            scene.add(particles);
            window.addEventListener('resize', onWindowResize, false);
            document.body.addEventListener('pointerdown', nextStep, false);
            nextStep();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function stopBreathingExercise() {
            breathingTimeouts.forEach(timeout => clearTimeout(timeout));
            breathingTimeouts = [];
            breathingIndicator.style.opacity = 0;
        }

        function startBreathingExercise() {
            storyOverlay.style.opacity = 0;
            breathingIndicator.style.opacity = 1;
            const sequence = [
                { text: "ရှူသွင်းပါ", duration: 4000, cameraZ: 4 },
                { text: "အောင့်ထားပါ", duration: 4000, cameraZ: 4 },
                { text: "ရှူထုတ်ပါ", duration: 6000, cameraZ: 9 }
            ];
            let delay = 0;
            sequence.forEach(step => {
                let timeout = setTimeout(() => {
                    breathingIndicator.textContent = step.text;
                    sceneState.cameraZ = step.cameraZ;
                }, delay);
                breathingTimeouts.push(timeout);
                delay += step.duration;
            });
            let finalTimeout = setTimeout(() => {
                breathingIndicator.style.opacity = 0;
                storyOverlay.style.opacity = 1;
            }, delay);
            breathingTimeouts.push(finalTimeout);
        }

        function nextStep() {
            if (!musicStarted) {
                music.play().catch(e => console.error("Autoplay was blocked.", e));
                musicStarted = true;
            }
            stopBreathingExercise();
            if (currentStep < story.length - 1) {
                currentStep++;
            } else {
                currentStep = 0;
            }
            if (currentStep > 0) prompt.style.display = 'none';
            if (currentStep === story.length - 1) {
                prompt.textContent = "ပြန်စရန် နှိပ်ပါ";
                prompt.style.display = 'block';
            }
            storyOverlay.style.opacity = 0;
            setTimeout(() => {
                storyTitle.textContent = story[currentStep].title;
                storyText.textContent = story[currentStep].text;
                if (currentStep !== 2) {
                    storyOverlay.style.opacity = 1;
                }
            }, 1000);
            if (currentStep === 2) {
                setTimeout(startBreathingExercise, 1500);
            }
            transitionScene(currentStep);
        }

        function transitionScene(step) {
            switch (step) {
                case 0: sceneState.particleSpeed = 0.005; sceneState.targetColor.set(0x555555); sceneState.cameraZ = 5; break;
                case 1: sceneState.particleSpeed = 0.002; sceneState.targetColor.set(0x4a69bd); break;
                case 2: sceneState.particleSpeed = 0.0005; break;
                case 3: sceneState.particleSpeed = 0.001; sceneState.targetColor.set(0x7ab5a3); sceneState.cameraZ = 6; break;
                case 4: sceneState.particleSpeed = 0.003; sceneState.targetColor.set(0xbd934a); break;
                case 5: sceneState.particleSpeed = 0.001; break;
                case 6: sceneState.particleSpeed = -0.002; sceneState.targetColor.set(0xffd700); break;
                case 7: sceneState.particleSpeed = 0.005; sceneState.targetColor.set(0xffffff); sceneState.cameraZ = 12; break;
            }
        }
        
        function animate() {
            requestAnimationFrame(animate);
            const positions = particles.geometry.attributes.position.array;
            for (let i = 0; i < positions.length; i += 3) {
                positions[i + 1] += sceneState.particleSpeed;
                if (positions[i + 1] > 10) positions[i + 1] = -10;
                else if (positions[i + 1] < -10) positions[i+1] = 10;
            }
            particles.geometry.attributes.position.needsUpdate = true;
            material.color.lerp(sceneState.targetColor, 0.05);
            camera.position.z += (sceneState.cameraZ - camera.position.z) * 0.02;
            renderer.render(scene, camera);
        }

        init();
        animate();
    </script>
</body>
</html>